@page
@model AS_Assignment_2_222256B.Pages.ChangePasswordModel
@{
	ViewData["Title"] = "Change Password";
}
<script>
	function validate() {
		var str = document.getElementById('pwdinput').value;
		var lbl_pwdchecker = document.querySelector('[data-valmsg-for="CModel.NewPassword"]');

		if (str.length < 15) {
			lbl_pwdchecker.innerHTML = "Password must be at least 15 characters long";
			lbl_pwdchecker.style.color = "red";
		} else if (str.search(/[0-9]/) == -1) {
			lbl_pwdchecker.innerHTML = "Password must contain at least one number";
			lbl_pwdchecker.style.color = "red";
		} else if (str.search(/[a-z]/) == -1) {
			lbl_pwdchecker.innerHTML = "Password must contain at least one lowercase character";
			lbl_pwdchecker.style.color = "red";
		} else if (str.search(/[A-Z]/) == -1) {
			lbl_pwdchecker.innerHTML = "Password must contain at least one uppercase character";
			lbl_pwdchecker.style.color = "red";
		} else if (str.search(/[!#$%^&*()_+{}\[\]:;<>,.?~\\/-]/) == -1) {
			lbl_pwdchecker.innerHTML = "Password must contain at least one special character";
			lbl_pwdchecker.style.color = "red";
		} else {
			lbl_pwdchecker.innerHTML = "";
		}
	}
</script>
<div class="container mt-5">

	<div class="row justify-content-center align-items-center">

		<div class="col-sm-12 col-md-12 col-lg-4">
			<h1 class="mb-3">Login</h1>

			<form id="form" method="post" asp-antiforgery="true">
				<div asp-validation-summary="All"></div>
				<div class="mb-3">
					<label class="form-label" asp-for="CModel.CurrentPassword">Original Password</label>
					<input type="Text" asp-for="CModel.CurrentPassword" class="form-control" />
					<span asp-validaton-for="CModel.CurrentPassword" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="CModel.NewPassword">New Password</label>
					<input id="pwdinput" onkeyup="validate()" type="text" asp-for="CModel.NewPassword" class="form-control" />
					<span asp-validation-for="CModel.NewPassword" class="text-danger"></span>
				</div>
				
				<div class="mb-3">
					<label class="form-label" asp-for="CModel.ConfirmPassword">Confirm Password</label>
					<input type="Text" asp-for="CModel.ConfirmPassword" class="form-control" />
					<span asp-validaton-for="CModel.ConfirmPassword" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<button type="submit" class="btn btn-primary">Login</button>
				</div>
			</form>
		</div>
	</div>
</div>